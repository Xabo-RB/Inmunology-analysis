(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16170,        491]
NotebookOptionsPosition[     13838,        444]
NotebookOutlinePosition[     14296,        461]
CellTagsIndexPosition[     14253,        458]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9458408870280037`*^9, 3.945840890220408*^9}, {
  3.945841041400922*^9, 
  3.945841044453947*^9}},ExpressionUUID->"ffe13ee7-6ebf-4cf1-8c48-\
2dfd241a5412"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9458415145924444`*^9, 
  3.945841515766065*^9}},ExpressionUUID->"aea76a5d-a9fc-46cf-a3a1-\
114d29bfe520"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{"kp", "-", 
        RowBox[{"koff", " ", 
         RowBox[{"(", 
          RowBox[{"psi", "-", "1"}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kp", " ", 
       RowBox[{"(", 
        RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"koff", "-", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"psi", "-", "2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.945840938888772*^9, 3.945840938888772*^9}, {
  3.9458415242234898`*^9, 3.945841526574018*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9646f98e-3298-4d59-bccf-96fbcd5dbfd6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"kp", " ", 
   RowBox[{"(", 
    RowBox[{"kp", "-", 
     RowBox[{"koff", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "psi"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"kp", " ", 
    RowBox[{"(", 
     RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
   RowBox[{"b", " ", 
    RowBox[{"(", 
     RowBox[{"koff", "-", 
      RowBox[{"kp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "psi"}], ")"}]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.945840941328924*^9, {3.945841518346791*^9, 3.945841527878314*^9}, {
   3.945841711433318*^9, 3.9458417388042955`*^9}},
 CellLabel->"Out[1]=",ExpressionUUID->"73b0917d-e0a1-41e0-9ecd-4c2a60893df3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "psi"}], ")"}], "/", "psi"}]}], "\n"}]], "Input",
 CellChangeTimes->{{3.9458409633317714`*^9, 3.9458409633327713`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a2cdfa72-9f87-494f-bdf1-43aeeae25a41"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "psi"}], "psi"]], "Output",
 CellChangeTimes->{
  3.945840964815806*^9, 3.9458415331470184`*^9, {3.9458417138864007`*^9, 
   3.9458417432470436`*^9}},
 CellLabel->"Out[2]=",ExpressionUUID->"028bef13-2379-4790-b041-ef56cd794be5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"f3", " ", "=", " ", 
  RowBox[{"koff", " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"koff", " ", "+", " ", "kp"}], ")"}]}]}], "\n", 
 RowBox[{"f4", " ", "=", " ", 
  RowBox[{"b", "/", " ", 
   RowBox[{"(", 
    RowBox[{"koff", " ", "+", " ", "kp"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.945840975525714*^9, 3.9458409755267134`*^9}, {
  3.9458415399743314`*^9, 3.9458415413898067`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"26a67125-14a7-4a9f-8807-9b1308dc6e67"],

Cell[BoxData[
 FractionBox["koff", 
  RowBox[{"koff", "+", "kp"}]]], "Output",
 CellChangeTimes->{3.945840978643654*^9, 3.9458415421749873`*^9, 
  3.945841744713759*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"28ed87a7-c964-4aa8-ac80-1f87e548c499"],

Cell[BoxData[
 FractionBox["b", 
  RowBox[{"koff", "+", "kp"}]]], "Output",
 CellChangeTimes->{3.945840978643654*^9, 3.9458415421749873`*^9, 
  3.945841744716759*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"89dd8240-eeb1-4ec1-97a0-663a23def890"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", " ", "=", 
  RowBox[{"f1", "+", 
   RowBox[{"a1", " ", "f1", " ", "f2"}], "+", 
   RowBox[{"a0", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f1", " ", "f2", " ", "f4"}], "+", "f3"}], ")"}]}]}]}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"3b2522ce-ef9f-4a3b-851a-8680c61e5597"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"kp", " ", 
    RowBox[{"(", 
     RowBox[{"kp", "-", 
      RowBox[{"koff", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "psi"}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"kp", " ", 
     RowBox[{"(", 
      RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{"koff", "-", 
       RowBox[{"kp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "psi"}], ")"}]}]}], ")"}]}]}]], "+", 
  RowBox[{"a0", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["koff", 
      RowBox[{"koff", "+", "kp"}]], "+", 
     FractionBox[
      RowBox[{"b", " ", "kp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "-", 
         RowBox[{"koff", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "psi"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "psi"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", "kp"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{"koff", "-", 
            RowBox[{"kp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "psi"}], ")"}]}]}], ")"}]}]}], ")"}], 
       " ", "psi"}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"a1", " ", "kp", " ", 
    RowBox[{"(", 
     RowBox[{"kp", "-", 
      RowBox[{"koff", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "psi"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "psi"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kp", " ", 
       RowBox[{"(", 
        RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"koff", "-", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "psi"}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", "psi"}]]}]], "Output",
 CellChangeTimes->{3.9458410475844173`*^9, 3.9458415499674377`*^9, 
  3.945841748566291*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"40b1bc29-6f05-4b89-9c0a-a73df2fccfec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"kp", "/", 
    RowBox[{"(", 
     RowBox[{"kp", "+", "k1"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.945841114526539*^9, 3.945841114526539*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"1d983fb7-2378-47d6-97ea-8446caa2f98f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"k1", " ", "=", " ", 
   RowBox[{"koff", " ", "+", " ", "b"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.945841122950344*^9, 3.9458411229513445`*^9}, 
   3.9458415611649337`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"2853c31f-6418-422d-b7a7-7b4ea2dfa12a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finalExpression", " ", "=", " ", 
  RowBox[{"expr", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"psi", " ", "->", " ", 
      RowBox[{"kp", " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"kp", " ", "+", " ", "k1"}], ")"}]}]}], ",", " ", 
     RowBox[{"k1", " ", "->", " ", 
      RowBox[{"koff", " ", "+", " ", "b"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9458411319551673`*^9, 3.9458411319551673`*^9}, 
   3.945841199854968*^9, {3.945841693872611*^9, 3.945841695608466*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"b2ef5ad8-86bf-4720-b7fe-dbeb6fb7e80d"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"kp", " ", 
    RowBox[{"(", 
     RowBox[{"kp", "-", 
      RowBox[{"koff", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox["kp", 
          RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"kp", " ", 
     RowBox[{"(", 
      RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{"koff", "-", 
       RowBox[{"kp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          FractionBox["kp", 
           RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}]}]}], ")"}]}]}]], 
  "+", 
  FractionBox[
   RowBox[{"a1", " ", 
    RowBox[{"(", 
     RowBox[{"b", "+", "koff", "+", "kp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["kp", 
       RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"kp", "-", 
      RowBox[{"koff", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox["kp", 
          RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"kp", " ", 
     RowBox[{"(", 
      RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{"koff", "-", 
       RowBox[{"kp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          FractionBox["kp", 
           RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}]}]}], ")"}]}]}]], 
  "+", 
  RowBox[{"a0", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["koff", 
      RowBox[{"koff", "+", "kp"}]], "+", 
     FractionBox[
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"b", "+", "koff", "+", "kp"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["kp", 
          RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"kp", "-", 
         RowBox[{"koff", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox["kp", 
             RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"koff", "+", "kp"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{"koff", "+", "kp"}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{"koff", "-", 
            RowBox[{"kp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               FractionBox["kp", 
                RowBox[{"b", "+", "koff", "+", "kp"}]]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.945841204142933*^9, 3.945841568659768*^9, 
  3.9458417625666475`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"66dbc6ed-0874-4b2e-aa99-e859dc1662f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FINAL", " ", "=", 
  RowBox[{"FullSimplify", "[", "finalExpression", "]"}]}]], "Input",
 CellChangeTimes->{{3.9458412145382776`*^9, 3.9458412159205914`*^9}},
 NumberMarks->False,
 CellLabel->"In[9]:=",ExpressionUUID->"cceb2b11-8423-4f8d-8a2a-ed9ef9151daf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a0", " ", 
     RowBox[{"(", 
      RowBox[{"b", "+", "koff", "+", "kp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["b", "2"], "+", 
       RowBox[{"2", " ", "b", " ", "koff"}], "+", 
       RowBox[{"koff", " ", "kp"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", "koff"}], ")"}]}], "+", "kp"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"koff", " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", "koff"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "koff"}], ")"}], " ", "kp"}], "+", 
       SuperscriptBox["kp", "2"]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"kp", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"koff", "+", "kp"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["b", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"koff", "+", 
       RowBox[{"2", " ", "kp"}]}], ")"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["koff", "2"], "+", 
       RowBox[{"4", " ", "koff", " ", "kp"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["kp", "2"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.945841210324315*^9, 3.9458412167927885`*^9}, 
   3.945841572910468*^9, 3.9458417674697623`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"9379bdbe-e904-4e5d-a863-12e041a25b69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "FINAL", "]"}]], "Input",
 CellChangeTimes->{{3.9458412204746284`*^9, 3.9458412592714767`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"99f7cdec-5409-44ea-b5eb-0ae24c78ff1d"],

Cell["\<\
\\frac{\\text{a0} (b+\\text{koff}+\\text{kp}) \\left(b^2+2 b
   \\text{koff}+\\text{koff} \\text{kp}\\right)+\\left(\\text{kp}
   (b+\\text{koff})+\\text{koff}
   (b+\\text{koff})+\\text{kp}^2\\right) (\\text{a1}
   (b+\\text{koff})+\\text{kp})}{b^2 (\\text{koff}+2 \\text{kp})+b
   \\left(\\text{koff}^2+4 \\text{koff} \\text{kp}+2
   \\text{kp}^2\\right)+\\text{kp} (\\text{koff}+\\text{kp})^2}\
\>", "Output",
 CellChangeTimes->{3.9458412604066153`*^9, 3.945841574840411*^9, 
  3.9458417712586365`*^9},
 CellLabel->
  "Out[10]//TeXForm=",ExpressionUUID->"7d18477d-68d2-404e-baef-5cc7dc84cc74"]
}, Open  ]]
},
WindowSize->{569.8867924528302, 627.622641509434},
WindowMargins->{{578.0377358490566, Automatic}, {
  132.4528301886793, Automatic}},
FrontEndVersion->"12.3 para Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"096ed202-2c68-4c56-9173-b4465b0a8a88"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 203, 4, 28, "Input",ExpressionUUID->"ffe13ee7-6ebf-4cf1-8c48-2dfd241a5412"],
Cell[764, 26, 154, 3, 28, "Input",ExpressionUUID->"aea76a5d-a9fc-46cf-a3a1-114d29bfe520"],
Cell[CellGroupData[{
Cell[943, 33, 817, 25, 67, "Input",ExpressionUUID->"9646f98e-3298-4d59-bccf-96fbcd5dbfd6"],
Cell[1763, 60, 746, 23, 51, "Output",ExpressionUUID->"73b0917d-e0a1-41e0-9ecd-4c2a60893df3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2546, 88, 296, 7, 48, "Input",ExpressionUUID->"a2cdfa72-9f87-494f-bdf1-43aeeae25a41"],
Cell[2845, 97, 276, 6, 51, "Output",ExpressionUUID->"028bef13-2379-4790-b041-ef56cd794be5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3158, 108, 495, 11, 48, "Input",ExpressionUUID->"26a67125-14a7-4a9f-8807-9b1308dc6e67"],
Cell[3656, 121, 247, 5, 51, "Output",ExpressionUUID->"28ed87a7-c964-4aa8-ac80-1f87e548c499"],
Cell[3906, 128, 244, 5, 51, "Output",ExpressionUUID->"89dd8240-eeb1-4ec1-97a0-663a23def890"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4187, 138, 323, 8, 28, "Input",ExpressionUUID->"3b2522ce-ef9f-4a3b-851a-8680c61e5597"],
Cell[4513, 148, 2356, 78, 133, "Output",ExpressionUUID->"40b1bc29-6f05-4b89-9c0a-a73df2fccfec"]
}, Open  ]],
Cell[6884, 229, 291, 7, 28, "Input",ExpressionUUID->"1d983fb7-2378-47d6-97ea-8446caa2f98f"],
Cell[7178, 238, 294, 6, 28, "Input",ExpressionUUID->"2853c31f-6418-422d-b7a7-7b4ea2dfa12a"],
Cell[CellGroupData[{
Cell[7497, 248, 608, 13, 28, "Input",ExpressionUUID->"b2ef5ad8-86bf-4720-b7fe-dbeb6fb7e80d"],
Cell[8108, 263, 3000, 97, 272, "Output",ExpressionUUID->"66dbc6ed-0874-4b2e-aa99-e859dc1662f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11145, 365, 280, 5, 43, "Input",ExpressionUUID->"cceb2b11-8423-4f8d-8a2a-ed9ef9151daf"],
Cell[11428, 372, 1535, 47, 78, "Output",ExpressionUUID->"9379bdbe-e904-4e5d-a863-12e041a25b69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13000, 424, 213, 3, 43, "Input",ExpressionUUID->"99f7cdec-5409-44ea-b5eb-0ae24c78ff1d"],
Cell[13216, 429, 606, 12, 147, "Output",ExpressionUUID->"7d18477d-68d2-404e-baef-5cc7dc84cc74"]
}, Open  ]]
}
]
*)

